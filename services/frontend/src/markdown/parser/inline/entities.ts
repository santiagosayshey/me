// HTML entities mapping
export const htmlEntities: Record<string, string> = {
  '&copy;': 'Â©',
  '&trade;': 'â„¢',
  '&reg;': 'Â®',
  '&lt;': '<',
  '&gt;': '>',
  '&amp;': '&',
  '&nbsp;': ' ',
  '&mdash;': 'â€”',
  '&ndash;': 'â€“',
  '&ldquo;': '"',
  '&rdquo;': '"',
  '&lsquo;': "'",
  '&rsquo;': "'",
  '&hellip;': 'â€¦',
  '&bull;': 'â€¢',
  '&middot;': 'Â·',
  '&deg;': 'Â°',
  '&plusmn;': 'Â±',
  '&times;': 'Ã—',
  '&divide;': 'Ã·',
  '&frac12;': 'Â½',
  '&frac14;': 'Â¼',
  '&frac34;': 'Â¾',
  '&euro;': 'â‚¬',
  '&pound;': 'Â£',
  '&yen;': 'Â¥',
  '&cent;': 'Â¢',
  '&sect;': 'Â§',
  '&para;': 'Â¶',
  '&dagger;': 'â€ ',
  '&Dagger;': 'â€¡',
  '&prime;': 'â€²',
  '&Prime;': 'â€³',
  '&infin;': 'âˆ',
  '&sum;': 'âˆ‘',
  '&minus;': 'âˆ’',
  '&lowast;': 'âˆ—',
  '&radic;': 'âˆš',
  '&prop;': 'âˆ',
  '&ne;': 'â‰ ',
  '&le;': 'â‰¤',
  '&ge;': 'â‰¥',
  '&asymp;': 'â‰ˆ',
  '&larr;': 'â†',
  '&uarr;': 'â†‘',
  '&rarr;': 'â†’',
  '&darr;': 'â†“',
  '&harr;': 'â†”',
  '&lArr;': 'â‡',
  '&uArr;': 'â‡‘',
  '&rArr;': 'â‡’',
  '&dArr;': 'â‡“',
  '&hArr;': 'â‡”'
};

// Common emoji shortcodes mapping
export const emojiShortcodes: Record<string, string> = {
  ':smile:': 'ğŸ˜Š',
  ':smiley:': 'ğŸ˜ƒ',
  ':grin:': 'ğŸ˜',
  ':laughing:': 'ğŸ˜†',
  ':sweat_smile:': 'ğŸ˜…',
  ':joy:': 'ğŸ˜‚',
  ':rofl:': 'ğŸ¤£',
  ':relaxed:': 'â˜ºï¸',
  ':blush:': 'ğŸ˜Š',
  ':innocent:': 'ğŸ˜‡',
  ':wink:': 'ğŸ˜‰',
  ':heart:': 'â¤ï¸',
  ':hearts:': 'â™¥ï¸',
  ':heart_eyes:': 'ğŸ˜',
  ':kissing_heart:': 'ğŸ˜˜',
  ':thinking:': 'ğŸ¤”',
  ':neutral_face:': 'ğŸ˜',
  ':expressionless:': 'ğŸ˜‘',
  ':confused:': 'ğŸ˜•',
  ':worried:': 'ğŸ˜Ÿ',
  ':frowning:': 'â˜¹ï¸',
  ':cry:': 'ğŸ˜¢',
  ':sob:': 'ğŸ˜­',
  ':rage:': 'ğŸ˜¡',
  ':angry:': 'ğŸ˜ ',
  ':thumbsup:': 'ğŸ‘',
  ':thumbsdown:': 'ğŸ‘',
  ':ok_hand:': 'ğŸ‘Œ',
  ':point_up:': 'â˜ï¸',
  ':point_down:': 'ğŸ‘‡',
  ':point_left:': 'ğŸ‘ˆ',
  ':point_right:': 'ğŸ‘‰',
  ':raised_hands:': 'ğŸ™Œ',
  ':pray:': 'ğŸ™',
  ':handshake:': 'ğŸ¤',
  ':clap:': 'ğŸ‘',
  ':muscle:': 'ğŸ’ª',
  ':star:': 'â­',
  ':star2:': 'ğŸŒŸ',
  ':fire:': 'ğŸ”¥',
  ':boom:': 'ğŸ’¥',
  ':rocket:': 'ğŸš€',
  ':airplane:': 'âœˆï¸',
  ':car:': 'ğŸš—',
  ':bus:': 'ğŸšŒ',
  ':train:': 'ğŸš‚',
  ':warning:': 'âš ï¸',
  ':exclamation:': 'â—',
  ':question:': 'â“',
  ':white_check_mark:': 'âœ…',
  ':x:': 'âŒ',
  ':negative_squared_cross_mark:': 'â',
  ':heavy_check_mark:': 'âœ”ï¸',
  ':heavy_multiplication_x:': 'âœ–ï¸',
  ':bangbang:': 'â€¼ï¸',
  ':interrobang:': 'â‰ï¸',
  ':100:': 'ğŸ’¯',
  ':heavy_plus_sign:': 'â•',
  ':heavy_minus_sign:': 'â–',
  ':heavy_division_sign:': 'â—',
  ':bulb:': 'ğŸ’¡',
  ':pushpin:': 'ğŸ“Œ',
  ':paperclip:': 'ğŸ“',
  ':bookmark:': 'ğŸ”–',
  ':link:': 'ğŸ”—',
  ':email:': 'âœ‰ï¸',
  ':envelope:': 'âœ‰ï¸',
  ':package:': 'ğŸ“¦',
  ':memo:': 'ğŸ“',
  ':page_facing_up:': 'ğŸ“„',
  ':calendar:': 'ğŸ“…',
  ':clock:': 'ğŸ•',
  ':alarm_clock:': 'â°',
  ':stopwatch:': 'â±ï¸',
  ':hourglass:': 'âŒ›',
  ':mag:': 'ğŸ”',
  ':mag_right:': 'ğŸ”',
  ':lock:': 'ğŸ”’',
  ':unlock:': 'ğŸ”“',
  ':key:': 'ğŸ”‘',
  ':hammer:': 'ğŸ”¨',
  ':wrench:': 'ğŸ”§',
  ':gear:': 'âš™ï¸',
  ':nut_and_bolt:': 'ğŸ”©',
  ':computer:': 'ğŸ’»',
  ':desktop:': 'ğŸ–¥ï¸',
  ':keyboard:': 'âŒ¨ï¸',
  ':mouse:': 'ğŸ–±ï¸',
  ':phone:': 'â˜ï¸',
  ':iphone:': 'ğŸ“±',
  ':calling:': 'ğŸ“²',
  ':tv:': 'ğŸ“º',
  ':camera:': 'ğŸ“·',
  ':video_camera:': 'ğŸ“¹',
  ':microphone:': 'ğŸ¤',
  ':speaker:': 'ğŸ”ˆ',
  ':sound:': 'ğŸ”‰',
  ':loud_sound:': 'ğŸ”Š',
  ':mute:': 'ğŸ”‡',
  ':bell:': 'ğŸ””',
  ':no_bell:': 'ğŸ”•',
  ':mega:': 'ğŸ“£',
  ':loudspeaker:': 'ğŸ“¢',
  ':eyes:': 'ğŸ‘€',
  ':eye:': 'ğŸ‘ï¸',
  ':ear:': 'ğŸ‘‚',
  ':nose:': 'ğŸ‘ƒ',
  ':tongue:': 'ğŸ‘…',
  ':lips:': 'ğŸ‘„',
  ':baby:': 'ğŸ‘¶',
  ':boy:': 'ğŸ‘¦',
  ':girl:': 'ğŸ‘§',
  ':man:': 'ğŸ‘¨',
  ':woman:': 'ğŸ‘©',
  ':wave:': 'ğŸ‘‹',
  ':information_source:': 'â„¹ï¸',
  ':arrows_clockwise:': 'ğŸ”ƒ',
  ':arrows_counterclockwise:': 'ğŸ”„',
  ':arrow_right:': 'â¡ï¸',
  ':arrow_left:': 'â¬…ï¸',
  ':arrow_up:': 'â¬†ï¸',
  ':arrow_down:': 'â¬‡ï¸',
  ':zap:': 'âš¡',
  ':sunny:': 'â˜€ï¸',
  ':cloud:': 'â˜ï¸',
  ':snowflake:': 'â„ï¸',
  ':umbrella:': 'â˜‚ï¸',
  ':coffee:': 'â˜•',
  ':pizza:': 'ğŸ•',
  ':hamburger:': 'ğŸ”',
  ':fries:': 'ğŸŸ',
  ':beer:': 'ğŸº',
  ':wine_glass:': 'ğŸ·',
  ':cocktail:': 'ğŸ¹',
  ':tropical_drink:': 'ğŸ¹',
  ':birthday:': 'ğŸ‚',
  ':cake:': 'ğŸ°',
  ':tada:': 'ğŸ‰',
  ':confetti_ball:': 'ğŸŠ',
  ':trophy:': 'ğŸ†',
  ':medal:': 'ğŸ…',
  ':soccer:': 'âš½',
  ':basketball:': 'ğŸ€',
  ':football:': 'ğŸˆ',
  ':baseball:': 'âš¾',
  ':tennis:': 'ğŸ¾',
  ':golf:': 'â›³',
  ':checkered_flag:': 'ğŸ',
  ':mountain:': 'â›°ï¸',
  ':beach:': 'ğŸ–ï¸',
  ':house:': 'ğŸ ',
  ':office:': 'ğŸ¢',
  ':school:': 'ğŸ«',
  ':hospital:': 'ğŸ¥',
  ':bank:': 'ğŸ¦',
  ':atm:': 'ğŸ§',
  ':hotel:': 'ğŸ¨',
  ':earth_americas:': 'ğŸŒ',
  ':earth_africa:': 'ğŸŒ',
  ':earth_asia:': 'ğŸŒ',
  ':globe:': 'ğŸŒ',
  ':moon:': 'ğŸŒ™',
  ':sun:': 'â˜€ï¸',
  ':dizzy:': 'ğŸ’«',
  ':sparkles:': 'âœ¨',
  ':rainbow:': 'ğŸŒˆ',
  ':ocean:': 'ğŸŒŠ',
  ':bamboo:': 'ğŸ‹',
  ':gift_heart:': 'ğŸ’',
  ':dolls:': 'ğŸ',
  ':school_satchel:': 'ğŸ’',
  ':mortar_board:': 'ğŸ“',
  ':flags:': 'ğŸ',
  ':fireworks:': 'ğŸ†',
  ':sparkler:': 'ğŸ‡',
  ':wind_chime:': 'ğŸ',
  ':jack_o_lantern:': 'ğŸƒ',
  ':ghost:': 'ğŸ‘»',
  ':santa:': 'ğŸ…',
  ':christmas_tree:': 'ğŸ„',
  ':gift:': 'ğŸ',
  ':tanabata_tree:': 'ğŸ‹',
  ':no_entry:': 'â›”',
  ':no_entry_sign:': 'ğŸš«',
  ':no_bicycles:': 'ğŸš³',
  ':no_smoking:': 'ğŸš­',
  ':no_littering:': 'ğŸš¯',
  ':do_not_litter:': 'ğŸš¯',
  ':no_pedestrians:': 'ğŸš·',
  ':no_mobile_phones:': 'ğŸ“µ',
  ':underage:': 'ğŸ”',
  ':accept:': 'ğŸ‰‘',
  ':ideograph_advantage:': 'ğŸ‰',
  ':white_flower:': 'ğŸ’®',
  ':secret:': 'ãŠ™ï¸',
  ':congratulations:': 'ãŠ—ï¸',
  ':u5408:': 'ğŸˆ´',
  ':u6e80:': 'ğŸˆµ',
  ':u7981:': 'ğŸˆ²',
  ':u6709:': 'ğŸˆ¶',
  ':u7121:': 'ğŸˆš',
  ':u7533:': 'ğŸˆ¸',
  ':u55b6:': 'ğŸˆº',
  ':u6708:': 'ğŸˆ·ï¸',
  ':eight_pointed_black_star:': 'âœ´ï¸',
  ':vs:': 'ğŸ†š',
  ':white_circle:': 'âšª',
  ':black_circle:': 'âš«',
  ':red_circle:': 'ğŸ”´',
  ':blue_circle:': 'ğŸ”µ',
  ':green_circle:': 'ğŸŸ¢',
  ':yellow_circle:': 'ğŸŸ¡',
  ':purple_circle:': 'ğŸŸ£',
  ':brown_circle:': 'ğŸŸ¤'
};

// Process text to replace HTML entities
export function processHtmlEntities(text: string): string {
  let result = text;
  
  // Replace named entities
  Object.entries(htmlEntities).forEach(([entity, char]) => {
    result = result.replace(new RegExp(entity.replace(/[.*+?^${}()|[\]\\]/g, '\\$&'), 'g'), char);
  });
  
  // Replace numeric entities (&#123; or &#x7B;)
  result = result.replace(/&#(\d+);/g, (match, code) => {
    return String.fromCharCode(parseInt(code, 10));
  });
  
  result = result.replace(/&#x([0-9a-fA-F]+);/g, (match, code) => {
    return String.fromCharCode(parseInt(code, 16));
  });
  
  return result;
}

// Process text to replace emoji shortcodes
export function processEmojiShortcodes(text: string): string {
  let result = text;
  
  // Sort by length to avoid partial replacements
  const sortedCodes = Object.keys(emojiShortcodes).sort((a, b) => b.length - a.length);
  
  sortedCodes.forEach(code => {
    const emoji = emojiShortcodes[code];
    // Use word boundaries to avoid replacing within words
    const regex = new RegExp(code.replace(/[.*+?^${}()|[\]\\]/g, '\\$&'), 'g');
    result = result.replace(regex, emoji);
  });
  
  return result;
}

// Process both entities and emojis
export function processSpecialCharacters(text: string): string {
  let result = processHtmlEntities(text);
  result = processEmojiShortcodes(result);
  return result;
}